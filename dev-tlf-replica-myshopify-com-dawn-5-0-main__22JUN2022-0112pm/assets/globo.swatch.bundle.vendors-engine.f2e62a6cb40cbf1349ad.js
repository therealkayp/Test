(window.webpackJsonpGVariant=window.webpackJsonpGVariant||[]).push([[4],{9:function(t,e,s){"use strict";s.d(e,"a",(function(){return Ce}));class r{valueOf(){}liquidMethodMissing(t){}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var n=function(){return(n=Object.assign||function(t){for(var e,s=1,r=arguments.length;s<r;s++)for(var n in e=arguments[s])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};const i=Object.prototype.toString,o=String.prototype.toLowerCase;function a(t){return"[object String]"===i.call(t)}function h(t){return"function"==typeof t}function l(t){return p(t=c(t))?"":String(t)}function c(t){return t instanceof r?t.valueOf():t}function u(t){return"number"==typeof t}function p(t){return null==t}function d(t){return"[object Array]"===i.call(t)}function f(t,e){t=t||{};for(const s in t)if(t.hasOwnProperty(s)&&!1===e(t[s],s,t))break;return t}function g(t){return t[t.length-1]}function m(t){const e=typeof t;return null!==t&&("object"===e||"function"===e)}function w(t,e,s=1){const r=[];for(let n=t;n<e;n+=s)r.push(n);return r}function y(t,e,s=" "){return T(t,e,s,(t,e)=>e+t)}function T(t,e,s,r){let n=e-(t=String(t)).length;for(;n-- >0;)t=r(t,s);return t}function k(t){return t}function b(t){return t.replace(/(\w?)([A-Z])/g,(t,e,s)=>(e?e+"_":"")+s.toLowerCase())}function v(t,e){return null==t&&null==e?0:null==t?1:null==e||(t=o.call(t))<(e=o.call(e))?-1:t>e?1:0}class x{constructor(t,e,s,r){this.key=t,this.value=e,this.next=s,this.prev=r}}class S{constructor(t,e=0){this.limit=t,this.size=e,this.cache={},this.head=new x("HEAD",null,null,null),this.tail=new x("TAIL",null,null,null),this.head.next=this.tail,this.tail.prev=this.head}write(t,e){if(this.cache[t])this.cache[t].value=e;else{const s=new x(t,e,this.head.next,this.head);this.head.next.prev=s,this.head.next=s,this.cache[t]=s,this.size++,this.ensureLimit()}}read(t){if(!this.cache[t])return;const{value:e}=this.cache[t];return this.remove(t),this.write(t,e),e}remove(t){const e=this.cache[t];e.prev.next=e.next,e.next.prev=e.prev,delete this.cache[t],this.size--}clear(){this.head.next=this.tail,this.tail.prev=this.head,this.size=0,this.cache={}}ensureLimit(){this.size>this.limit&&this.remove(this.tail.prev.key)}}const O={root:["."],cache:void 0,extname:"",dynamicPartials:!0,jsTruthy:!1,trimTagRight:!1,trimTagLeft:!1,trimOutputRight:!1,trimOutputLeft:!1,greedy:!0,tagDelimiterLeft:"{%",tagDelimiterRight:"%}",outputDelimiterLeft:"{{",outputDelimiterRight:"}}",strictFilters:!1,strictVariables:!1,globals:{}};function q(t){if((t=t||{}).hasOwnProperty("root")&&(t.root=R(t.root)),t.hasOwnProperty("cache")){let e;e="number"==typeof t.cache?t.cache>0?new S(t.cache):void 0:"object"==typeof t.cache?t.cache:t.cache?new S(1024):void 0,t.cache=e}return t}function R(t){return d(t)?t:a(t)?[t]:[]}class F{constructor(t={},e=O,s=!1){this.scopes=[{}],this.registers={},this.sync=s,this.opts=e,this.globals=e.globals,this.environments=t}getRegister(t,e={}){return this.registers[t]=this.registers[t]||e}setRegister(t,e){return this.registers[t]=e}saveRegister(...t){return t.map(t=>[t,this.getRegister(t)])}restoreRegister(t){return t.forEach(([t,e])=>this.setRegister(t,e))}getAll(){return[this.globals,this.environments,...this.scopes].reduce((t,e)=>n(t,e),{})}get(t){const e=this.findScope(t[0]);return this.getFromScope(e,t)}getFromScope(t,e){return"string"==typeof e&&(e=e.split(".")),e.reduce((t,e)=>{if(t=function(t,e){if(p(t))return t;if((t=function t(e){return e&&h(e.toLiquid)?t(e.toLiquid()):e}(t))instanceof r)return h(t[e])?t[e]():t.hasOwnProperty(e)?t[e]:t.liquidMethodMissing(e);return"size"===e?function(t){return d(t)||a(t)?t.length:t.size}(t):"first"===e?function(t){return d(t)?t[0]:t.first}(t):"last"===e?function(t){return d(t)?t[t.length-1]:t.last}(t):t[e]}(t,e),p(t)&&this.opts.strictVariables)throw new TypeError("undefined variable: "+e);return t},t)}push(t){return this.scopes.push(t)}pop(){return this.scopes.pop()}bottom(){return this.scopes[0]}findScope(t){for(let e=this.scopes.length-1;e>=0;e--){const s=this.scopes[e];if(t in s)return s}return t in this.environments?this.environments:this.globals}}var L,M=Object.freeze({resolve:function(t,e,s){return t.length&&"/"!==g(t)&&(t+="/"),function(t,e){const s=document.createElement("base");s.href=t;const r=document.getElementsByTagName("head")[0];r.insertBefore(s,r.firstChild);const n=document.createElement("a");n.href=e;const i=n.href;return r.removeChild(s),i}(t,e).replace(/^(\w+:\/\/[^/]+)(\/[^?]+)/,(t,e,r)=>{const n=r.split("/").pop();return/\.\w+$/.test(n)?t:e+r+s})},readFile:async function(t){return new Promise((e,s)=>{const r=new XMLHttpRequest;r.onload=()=>{r.status>=200&&r.status<300?e(r.responseText):s(new Error(r.statusText))},r.onerror=()=>{s(new Error("An error occurred whilst receiving the response."))},r.open("GET",t),r.send()})},readFileSync:function(t){const e=new XMLHttpRequest;if(e.open("GET",t,!1),e.send(),e.status<200||e.status>=300)throw new Error(e.statusText);return e.responseText},exists:async function(t){return!0},existsSync:function(t){return!0}});function E(t){return!!(H(t)&L.Delimited)}function N(t){return H(t)===L.Operator}function D(t){return H(t)===L.HTML}function A(t){return H(t)===L.Output}function $(t){return H(t)===L.Tag}function P(t){return H(t)===L.Quoted}function V(t){return H(t)===L.Literal}function j(t){return H(t)===L.Number}function W(t){return H(t)===L.PropertyAccess}function C(t){return H(t)===L.Word}function B(t){return H(t)===L.Range}function H(t){return t?t.kind:-1}!function(t){t[t.Number=1]="Number",t[t.Literal=2]="Literal",t[t.Tag=4]="Tag",t[t.Output=8]="Output",t[t.HTML=16]="HTML",t[t.Filter=32]="Filter",t[t.Hash=64]="Hash",t[t.PropertyAccess=128]="PropertyAccess",t[t.Word=256]="Word",t[t.Range=512]="Range",t[t.Quoted=1024]="Quoted",t[t.Operator=2048]="Operator",t[t.Delimited=12]="Delimited"}(L||(L={}));const _=[0,0,0,0,0,0,0,0,0,20,4,4,4,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,2,8,0,0,0,0,8,0,0,0,64,0,65,0,0,33,33,33,33,33,33,33,33,33,33,0,0,2,2,2,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0];function z(t,e){if(!t||!D(t))return;const s=e?4:16;for(;_[t.input.charCodeAt(t.end-1-t.trimRight)]&s;)t.trimRight++}function U(t,e){if(!t||!D(t))return;const s=e?4:16;for(;_[t.input.charCodeAt(t.begin+t.trimLeft)]&s;)t.trimLeft++;"\n"===t.input.charAt(t.begin+t.trimLeft)&&t.trimLeft++}_[160]=_[5760]=_[6158]=_[8192]=_[8193]=_[8194]=_[8195]=_[8196]=_[8197]=_[8198]=_[8199]=_[8200]=_[8201]=_[8202]=_[8232]=_[8233]=_[8239]=_[8287]=_[12288]=4;class J{constructor(t,e,s,r,n){this.kind=t,this.input=e,this.begin=s,this.end=r,this.file=n}getText(){return this.input.slice(this.begin,this.end)}getPosition(){let[t,e]=[1,1];for(let s=0;s<this.begin;s++)"\n"===this.input[s]?(t++,e=1):e++;return[t,e]}size(){return this.end-this.begin}}class Q extends J{constructor(t,e){super(L.Number,t.input,t.begin,e?e.end:t.end,t.file),this.whole=t,this.decimal=e}}class I extends J{constructor(t,e,s,r){super(L.Word,t,e,s,r),this.input=t,this.begin=e,this.end=s,this.file=r,this.content=this.getText()}isNumber(t=!1){for(let e=t&&64&_[this.input.charCodeAt(this.begin)]?this.begin+1:this.begin;e<this.end;e++)if(!(32&_[this.input.charCodeAt(e)]))return!1;return!0}}class Y extends r{equals(t){return a(t)||d(t)?0===t.length:!!m(t)&&0===Object.keys(t).length}gt(){return!1}geq(){return!1}lt(){return!1}leq(){return!1}valueOf(){return""}}class G extends Y{equals(t){return!1===t||(!!p(c(t))||(a(t)?/^\s*$/.test(t):super.equals(t)))}}class X extends r{equals(t){return p(c(t))||t instanceof G}gt(){return!1}geq(){return!1}lt(){return!1}leq(){return!1}valueOf(){return null}}const Z={true:!0,false:!1,nil:new X,null:new X,empty:new Y,blank:new G};class K extends J{constructor(t,e,s,r){super(L.Literal,t,e,s,r),this.input=t,this.begin=e,this.end=s,this.file=r,this.literal=this.getText()}}const tt={"==":1,"!=":1,">":1,"<":1,">=":1,"<=":1,contains:1,and:0,or:0};class et extends J{constructor(t,e,s,r){super(L.Operator,t,e,s,r),this.input=t,this.begin=e,this.end=s,this.file=r,this.operator=this.getText()}getPrecedence(){return tt[this.getText()]}}const st=/[\da-fA-F]/,rt=/[0-7]/,nt={b:"\b",f:"\f",n:"\n",r:"\r",t:"\t",v:"\v"};function it(t){const e=t.charCodeAt(0);return e>=97?e-87:e>=65?e-55:e-48}function ot(t){let e="";for(let s=1;s<t.length-1;s++)if("\\"===t[s])if(void 0!==nt[t[s+1]])e+=nt[t[++s]];else if("u"===t[s+1]){let r=0,n=s+2;for(;n<=s+5&&st.test(t[n]);)r=16*r+it(t[n++]);s=n-1,e+=String.fromCharCode(r)}else if(rt.test(t[s+1])){let r=s+1,n=0;for(;r<=s+3&&rt.test(t[r]);)n=8*n+it(t[r++]);s=r-1,e+=String.fromCharCode(n)}else e+=t[++s];else e+=t[s];return e}class at extends J{constructor(t,e,s){super(L.PropertyAccess,t.input,t.begin,s,t.file),this.variable=t,this.props=e}getVariableAsText(){return this.variable instanceof I?this.variable.getText():ot(this.variable.getText())}}class ht extends Error{constructor(t,e){super(t.message),this.originalError=t,this.token=e}update(){const t=this.originalError,e=function(t){const[e]=t.getPosition(),s=t.input.split("\n"),r=Math.max(e-2,1),n=Math.min(e+3,s.length);return w(r,n+1).map(t=>`${t===e?">> ":"   "}${y(String(t),String(n).length)}| ${s[t-1]}`).join("\n")}(this.token);this.message=function(t,e){e.file&&(t+=", file:"+e.file);const[s,r]=e.getPosition();return t+=`, line:${s}, col:${r}`}(t.message,this.token),this.stack=this.message+"\n"+e+"\n"+this.stack+"\nFrom "+t.stack}}class lt extends ht{constructor(t,e){super(new Error(t),e),this.name="TokenizationError",super.update()}}class ct extends ht{constructor(t,e){super(t,e),this.name="ParseError",this.message=t.message,super.update()}}class ut extends ht{constructor(t,e){super(t,e.token),this.name="RenderError",this.message=t.message,super.update()}static is(t){return t instanceof ut}}class pt extends Error{constructor(t){super(t),this.name="AssertionError",this.message=t+""}}function dt(t,e){if(!t){const s=e?e():`expect ${t} to be true`;throw new pt(s)}}class ft extends J{constructor(t,e,s,r,n,i){super(L.Filter,s,r,n,i),this.name=t,this.args=e}}class gt extends J{constructor(t,e,s,r,n,i){super(L.Hash,t,e,s,i),this.input=t,this.begin=e,this.end=s,this.name=r,this.value=n,this.file=i}}class mt extends J{constructor(t,e,s,r){super(L.Quoted,t,e,s,r),this.input=t,this.begin=e,this.end=s,this.file=r}}class wt extends J{constructor(t,e,s,r){super(L.HTML,t,e,s,r),this.input=t,this.begin=e,this.end=s,this.file=r,this.trimLeft=0,this.trimRight=0}getContent(){return this.input.slice(this.begin+this.trimLeft,this.end-this.trimRight)}}class yt extends J{constructor(t,e,s,r,n,i,o,a){super(t,s,r,n,a),this.trimLeft=!1,this.trimRight=!1,this.content=this.getText();const h="-"===e[0],l="-"===g(e);this.content=e.slice(h?1:0,l?-1:e.length).trim(),this.trimLeft=h||i,this.trimRight=l||o}}class Tt extends yt{constructor(t,e,s,r,n){const{trimTagLeft:i,trimTagRight:o,tagDelimiterLeft:a,tagDelimiterRight:h}=r,l=t.slice(e+a.length,s-h.length);super(L.Tag,l,t,e,s,i,o,n);let c=0;for(;1&_[this.content.charCodeAt(c)];)c++;if(this.name=this.content.slice(0,c),!this.name)throw new lt("illegal tag syntax",this);let u=c;for(;4&_[this.content.charCodeAt(u)];)u++;this.args=this.content.slice(u)}}class kt extends J{constructor(t,e,s,r,n,i){super(L.Range,t,e,s,i),this.input=t,this.begin=e,this.end=s,this.lhs=r,this.rhs=n,this.file=i}}class bt extends yt{constructor(t,e,s,r,n){const{trimOutputLeft:i,trimOutputRight:o,outputDelimiterLeft:a,outputDelimiterRight:h}=r,l=t.slice(e+a.length,s-h.length);super(L.Output,l,t,e,s,i,o,n)}}const vt={a:{n:{d:{end:!0,needBoundary:!0}}},o:{r:{end:!0,needBoundary:!0}},c:{o:{n:{t:{a:{i:{n:{s:{end:!0,needBoundary:!0}}}}}}}},"=":{"=":{end:!0}},"!":{"=":{end:!0}},">":{end:!0,"=":{end:!0}},"<":{end:!0,"=":{end:!0}}};class xt{constructor(t,e=""){this.input=t,this.file=e,this.p=0,this.N=t.length}*readExpression(){const t=this.readValue();if(t)for(yield t;this.p<this.N;){const t=this.readOperator();if(!t)return;const e=this.readValue();if(!e)return;yield t,yield e}}readOperator(){this.skipBlank();const t=function(t,e,s=t.length){let r,n=vt,i=e;for(;n[t[i]]&&i<s;)n=n[t[i++]],n.end&&(r=n);return r?r.needBoundary&&1&t.charCodeAt(i)?-1:i:-1}(this.input,this.p,this.p+8);if(-1!==t)return new et(this.input,this.p,this.p=t,this.file)}readFilters(){const t=[];for(;;){const e=this.readFilter();if(!e)return t;t.push(e)}}readFilter(){if(this.skipBlank(),this.end())return null;dt("|"===this.peek(),()=>"unexpected token at "+this.snapshot()),this.p++;const t=this.p,e=this.readWord();if(!e.size())return null;const s=[];if(this.skipBlank(),":"===this.peek())do{++this.p;const t=this.readFilterArg();for(t&&s.push(t);this.p<this.N&&","!==this.peek()&&"|"!==this.peek();)++this.p}while(","===this.peek());return new ft(e.getText(),s,this.input,t,this.p,this.file)}readFilterArg(){const t=this.readValue();if(!t)return;if(this.skipBlank(),":"!==this.peek())return t;++this.p;const e=this.readValue();return[t.getText(),e]}readTopLevelTokens(t=O){const e=[];for(;this.p<this.N;){const s=this.readTopLevelToken(t);e.push(s)}return function(t,e){e=Object.assign({greedy:!0},e);let s=!1;for(let r=0;r<t.length;r++){const n=t[r];E(n)&&(!s&&n.trimLeft&&z(t[r-1],e.greedy),$(n)&&("raw"===n.name?s=!0:"endraw"===n.name&&(s=!1)),!s&&n.trimRight&&U(t[r+1],e.greedy))}}(e,t),e}readTopLevelToken(t){const{tagDelimiterLeft:e,outputDelimiterLeft:s}=t;return this.matchWord(e)?this.readTagToken(t):this.matchWord(s)?this.readOutputToken(t):this.readHTMLToken(t)}readHTMLToken(t){const e=this.p;for(;this.p<this.N;){const{tagDelimiterLeft:e,outputDelimiterLeft:s}=t;if(this.matchWord(e))break;if(this.matchWord(s))break;++this.p}return new wt(this.input,e,this.p,this.file)}readTagToken(t){const{file:e,input:s}=this,{tagDelimiterRight:r}=t,n=this.p;return-1===this.readTo(r)&&this.mkError(`tag ${this.snapshot(n)} not closed`,n),new Tt(s,n,this.p,t,e)}readOutputToken(t){const{file:e,input:s}=this,{outputDelimiterRight:r}=t,n=this.p;return-1===this.readTo(r)&&this.mkError(`output ${this.snapshot(n)} not closed`,n),new bt(s,n,this.p,t,e)}mkError(t,e){throw new lt(t,new I(this.input,e,this.N,this.file))}snapshot(t=this.p){return JSON.stringify((e=this.input.slice(t),s=16,e.length>s?e.substr(0,s-3)+"...":e));var e,s}readWord(){this.skipBlank();const t=this.p;for(;1&this.peekType();)++this.p;return new I(this.input,t,this.p,this.file)}readHashes(){const t=[];for(;;){const e=this.readHash();if(!e)return t;t.push(e)}}readHash(){this.skipBlank(),","===this.peek()&&++this.p;const t=this.p,e=this.readWord();if(!e.size())return;let s;return this.skipBlank(),":"===this.peek()&&(++this.p,s=this.readValue()),new gt(this.input,t,this.p,e,s,this.file)}remaining(){return this.input.slice(this.p)}advance(t=1){this.p+=t}end(){return this.p>=this.N}readTo(t){for(;this.p<this.N;)if(++this.p,this.reverseMatchWord(t))return this.p;return-1}readValue(){const t=this.readQuoted()||this.readRange();if(t)return t;if("["===this.peek()){this.p++;const t=this.readQuoted();if(!t)return;if("]"!==this.peek())return;return this.p++,new at(t,[],this.p)}const e=this.readWord();if(!e.size())return;let s=e.isNumber(!0);const r=[];for(;;)if("["===this.peek()){s=!1,this.p++;const t=this.readValue()||new I(this.input,this.p,this.p,this.file);this.readTo("]"),r.push(t)}else{if("."!==this.peek()||"."===this.peek(1))break;{this.p++;const t=this.readWord();if(!t.size())break;t.isNumber()||(s=!1),r.push(t)}}return!r.length&&Z.hasOwnProperty(e.content)?new K(this.input,e.begin,e.end,this.file):s?new Q(e,r[0]):new at(e,r,this.p)}readRange(){this.skipBlank();const t=this.p;if("("!==this.peek())return;++this.p;const e=this.readValueOrThrow();this.p+=2;const s=this.readValueOrThrow();return++this.p,new kt(this.input,t,this.p,e,s,this.file)}readValueOrThrow(){const t=this.readValue();return dt(t,()=>`unexpected token ${this.snapshot()}, value expected`),t}readQuoted(){this.skipBlank();const t=this.p;if(!(8&this.peekType()))return;++this.p;let e=!1;for(;this.p<this.N&&(++this.p,this.input[this.p-1]!==this.input[t]||e);)e?e=!1:"\\"===this.input[this.p-1]&&(e=!0);return new mt(this.input,t,this.p,this.file)}readFileName(){const t=this.p;for(;!(4&this.peekType())&&","!==this.peek()&&this.p<this.N;)this.p++;return new I(this.input,t,this.p,this.file)}matchWord(t){for(let e=0;e<t.length;e++)if(t[e]!==this.input[this.p+e])return!1;return!0}reverseMatchWord(t){for(let e=0;e<t.length;e++)if(t[t.length-1-e]!==this.input[this.p-1-e])return!1;return!0}peekType(t=0){return _[this.input.charCodeAt(this.p+t)]}peek(t=0){return this.input[this.p+t]}skipBlank(){for(;4&this.peekType();)++this.p}}class St{constructor(){this.html="",this.break=!1,this.continue=!1}write(t){this.html+=t}}class Ot{*renderTemplates(t,e,s=new St){for(const r of t)try{const t=yield r.render(e,s);if(t&&s.write(t),s.break||s.continue)break}catch(t){throw ut.is(t)?t:new ut(t,r)}return s.html}}class qt{constructor(t,e){this.handlers={},this.stopRequested=!1,this.tokens=t,this.parseToken=e}on(t,e){return this.handlers[t]=e,this}trigger(t,e){const s=this.handlers[t];return!!s&&(s(e),!0)}start(){let t;for(this.trigger("start");!this.stopRequested&&(t=this.tokens.shift());){if(this.trigger("token",t))continue;if($(t)&&this.trigger("tag:"+t.name,t))continue;const e=this.parseToken(t,this.tokens);this.trigger("template",e)}return this.stopRequested||this.trigger("end"),this}stop(){return this.stopRequested=!0,this}}class Rt{constructor(t){this.token=t}}function Ft(t){return t&&h(t.equals)}function Lt(t,e){return!Mt(t,e)}function Mt(t,e){return e.opts.jsTruthy?!t:!1===t||null==t}const Et={"==":(t,e)=>Ft(t)?t.equals(e):Ft(e)?e.equals(t):t===e,"!=":(t,e)=>Ft(t)?!t.equals(e):Ft(e)?!e.equals(t):t!==e,">":(t,e)=>Ft(t)?t.gt(e):Ft(e)?e.lt(t):t>e,"<":(t,e)=>Ft(t)?t.lt(e):Ft(e)?e.gt(t):t<e,">=":(t,e)=>Ft(t)?t.geq(e):Ft(e)?e.leq(t):t>=e,"<=":(t,e)=>Ft(t)?t.leq(e):Ft(e)?e.geq(t):t<=e,contains:(t,e)=>!(!t||!h(t.indexOf))&&t.indexOf(e)>-1,and:(t,e,s)=>Lt(t,s)&&Lt(e,s),or:(t,e,s)=>Lt(t,s)||Lt(e,s)};class Nt{constructor(t){this.operands=[];const e=new xt(t);this.postfix=function*(t){const e=[];for(const s of t)if(N(s)){for(;e.length&&e[e.length-1].getPrecedence()>s.getPrecedence();)yield e.pop();e.push(s)}else yield s;for(;e.length;)yield e.pop()}(e.readExpression())}evaluate(t){for(const e of this.postfix)if(N(e)){const s=this.operands.pop(),r=$t(e,this.operands.pop(),s,t);this.operands.push(r)}else this.operands.push(Dt(e,t));return this.operands[0]}*value(t){return c(this.evaluate(t))}}function Dt(t,e){if(dt(e,()=>"unable to evaluate: context not defined"),W(t)){const s=t.getVariableAsText(),r=t.props.map(t=>Dt(t,e));return e.get([s,...r])}return B(t)?function(t,e){const s=Dt(t.lhs,e),r=Dt(t.rhs,e);return w(+s,+r+1)}(t,e):V(t)?function(t){return Z[t.literal]}(t):j(t)?function(t){const e=t.whole.content+"."+(t.decimal?t.decimal.content:"");return Number(e)}(t):C(t)?t.getText():P(t)?At(t):void 0}function At(t){return ot(t.getText())}function $t(t,e,s,r){return(0,Et[t.operator])(e,s,r)}class Pt{constructor(t){this.hash={};const e=new xt(t);for(const t of e.readHashes())this.hash[t.name.content]=t.value}*render(t){const e={};for(const s of Object.keys(this.hash))e[s]=yield Dt(this.hash[s],t);return e}}function Vt(t){const e={then:e=>e(t),catch:()=>e};return e}function jt(t){const e={then:(s,r)=>r?r(t):e,catch:e=>e(t)};return e}function Wt(t){return function(t){return t&&h(t.then)}(t)?t:function(t){return t&&h(t.next)&&h(t.throw)&&h(t.return)}(t)?function e(s){let r;try{r=t.next(s)}catch(t){return jt(t)}return r.done?Vt(r.value):Wt(r.value).then(e,s=>{let r;try{r=t.throw(s)}catch(t){return jt(t)}return r.done?Vt(r.value):e(r.value)})}():Vt(t)}function Ct(t){return Promise.resolve(Wt(t))}function Bt(t){let e;return Wt(t).then(t=>(e=t,Vt(e))).catch(t=>{throw t}),e}class Ht extends Rt{constructor(t,e,s){super(t),this.name=t.name;const r=s.tags.get(t.name);this.impl=Object.create(r),this.impl.liquid=s,this.impl.parse&&this.impl.parse(t,e)}*render(t,e){const s=yield new Pt(this.token.args).render(t),r=this.impl;if(h(r.render))return yield r.render(t,e,s)}}Ht.impls={};class _t{constructor(t,e,s){this.name=t,this.impl=e||k,this.args=s}*render(t,e){const s=[];for(const t of this.args)d(t)?s.push([t[0],yield Dt(t[1],e)]):s.push(yield Dt(t,e));return yield this.impl.apply({context:e},[t,...s])}}class zt{constructor(t,e){this.filterMap=e,this.filters=[];const s=new xt(t);this.initial=s.readValue(),this.filters=s.readFilters().map(({name:t,args:e})=>new _t(t,this.filterMap.get(t),e))}*value(t){let e=yield Dt(this.initial,t);for(const s of this.filters)e=yield s.render(e,t);return e}}class Ut extends Rt{constructor(t,e){super(t),this.value=new zt(t.content,e)}*render(t,e){const s=yield this.value.value(t);e.write(l(c(s)))}}class Jt extends Rt{constructor(t){super(t),this.str=t.getContent()}*render(t,e){e.write(this.str)}}class Qt{constructor(t){this.liquid=t}parse(t){let e;const s=[];for(;e=t.shift();)s.push(this.parseToken(e,t));return s}parseToken(t,e){try{return $(t)?new Ht(t,e,this.liquid):A(t)?new Ut(t,this.liquid.filters):new Jt(t)}catch(e){throw new ct(e,t)}}parseStream(t){return new qt(t,(t,e)=>this.parseToken(t,e))}}var It={parse:function(t){const e=new xt(t.args);this.key=e.readWord().content,e.skipBlank(),dt("="===e.peek(),()=>"illegal token "+t.getText()),e.advance(),this.value=e.remaining()},render:function*(t){t.bottom()[this.key]=yield this.liquid._evalValue(this.value,t)}};function Yt(t){return d(t)?t:a(t)&&t.length>0?[t]:m(t)?Object.keys(t).map(e=>[e,t[e]]):[]}function Gt(t){return d(t)?t:[t]}class Xt extends r{constructor(t){super(),this.i=0,this.length=t}next(){this.i++}index0(){return this.i}index(){return this.i+1}first(){return 0===this.i}last(){return this.i===this.length-1}rindex(){return this.length-this.i}rindex0(){return this.length-this.i-1}valueOf(){return JSON.stringify(this)}}var Zt={type:"block",parse:function(t,e){const s=new xt(t.args),r=s.readWord(),n=s.readWord(),i=s.readValue();let o;dt(r.size()&&"in"===n.content&&i,()=>"illegal tag: "+t.getText()),this.variable=r.content,this.collection=i,this.hash=new Pt(s.remaining()),this.templates=[],this.elseTemplates=[];const a=this.liquid.parser.parseStream(e).on("start",()=>o=this.templates).on("tag:else",()=>o=this.elseTemplates).on("tag:endfor",()=>a.stop()).on("template",t=>o.push(t)).on("end",()=>{throw new Error(`tag ${t.getText()} not closed`)});a.start()},render:function*(t,e){const s=this.liquid.renderer;let r=Yt(yield Dt(this.collection,t));if(!r.length)return void(yield s.renderTemplates(this.elseTemplates,t,e));const n=yield this.hash.render(t),i=n.offset||0,o=void 0===n.limit?r.length:n.limit;r=r.slice(i,i+o),"reversed"in n&&r.reverse();const a={forloop:new Xt(r.length)};t.push(a);for(const n of r){if(a[this.variable]=n,yield s.renderTemplates(this.templates,t,e),e.break){e.break=!1;break}e.continue=!1,a.forloop.next()}t.pop()}},Kt={parse:function(t,e){const s=new xt(t.args);this.variable=function(t){const e=t.readWord().content;if(e)return e;const s=t.readQuoted();if(s)return At(s)}(s),dt(this.variable,()=>t.args+" not valid identifier"),this.templates=[];const r=this.liquid.parser.parseStream(e);r.on("tag:endcapture",()=>r.stop()).on("template",t=>this.templates.push(t)).on("end",()=>{throw new Error(`tag ${t.getText()} not closed`)}),r.start()},render:function*(t){const e=this.liquid.renderer,s=yield e.renderTemplates(this.templates,t);t.bottom()[this.variable]=s}};var te,ee={parse:function(t,e){this.cond=t.args,this.cases=[],this.elseTemplates=[];let s=[];const r=this.liquid.parser.parseStream(e).on("tag:when",t=>{this.cases.push({val:t.args,templates:s=[]})}).on("tag:else",()=>s=this.elseTemplates).on("tag:endcase",()=>r.stop()).on("template",t=>s.push(t)).on("end",()=>{throw new Error(`tag ${t.getText()} not closed`)});r.start()},render:function*(t,e){const s=this.liquid.renderer,r=yield new Nt(this.cond).value(t);for(let n=0;n<this.cases.length;n++){const i=this.cases[n];if((yield new Nt(i.val).value(t))===r)return void(yield s.renderTemplates(i.templates,t,e))}yield s.renderTemplates(this.elseTemplates,t,e)}},se={parse:function(t,e){const s=this.liquid.parser.parseStream(e);s.on("token",t=>{"endcomment"===t.name&&s.stop()}).on("end",()=>{throw new Error(`tag ${t.getText()} not closed`)}),s.start()}};!function(t){t[t.OUTPUT=0]="OUTPUT",t[t.STORE=1]="STORE"}(te||(te={}));var re=te,ne={parse:function(t){const e=t.args,s=new xt(e);this.file=this.liquid.options.dynamicPartials?s.readValue():s.readFileName(),dt(this.file,()=>`illegal argument "${t.args}"`);const r=s.p;"with"===s.readWord().content?(s.skipBlank(),":"!==s.peek()?this.withVar=s.readValue():s.p=r):s.p=r,this.hash=new Pt(s.remaining())},render:function*(t,e){const{liquid:s,hash:r,withVar:n,file:i}=this,{renderer:o}=s,a=t.opts.dynamicPartials?P(i)?yield o.renderTemplates(s.parse(At(i)),t):yield Dt(i,t):i.getText();dt(a,()=>`illegal filename "${i.getText()}":"${a}"`);const h=t.saveRegister("blocks","blockMode");t.setRegister("blocks",{}),t.setRegister("blockMode",re.OUTPUT);const l=yield r.render(t);n&&(l[a]=Dt(n,t));const c=yield s._parseFile(a,t.opts,t.sync);t.push(l),yield o.renderTemplates(c,t,e),t.pop(),t.restoreRegister(h)}},ie={parse:function(t){const e=t.args,s=new xt(e);for(this.file=this.liquid.options.dynamicPartials?s.readValue():s.readFileName(),dt(this.file,()=>`illegal argument "${t.args}"`);!s.end();){s.skipBlank();const t=s.p,e=s.readWord();if(("with"===e.content||"for"===e.content)&&(s.skipBlank(),":"!==s.peek())){const t=s.readValue();if(t){const r=s.p;let n;"as"===s.readWord().content?n=s.readWord():s.p=r,this[e.content]={value:t,alias:n&&n.content},s.skipBlank(),","===s.peek()&&s.advance();continue}}s.p=t;break}this.hash=new Pt(s.remaining())},render:function*(t,e){const{liquid:s,file:r,hash:n}=this,{renderer:i}=s,o=t.opts.dynamicPartials?P(r)?yield i.renderTemplates(s.parse(At(r)),t):Dt(r,t):r.getText();dt(o,()=>`illegal filename "${r.getText()}":"${o}"`);const a=new F({},t.opts,t.sync),h=yield n.render(t);if(this.with){const{value:e,alias:s}=this.with;h[s||o]=Dt(e,t)}if(a.push(h),this.for){const{value:r,alias:n}=this.for;let l=Dt(r,t);l=Yt(l),h.forloop=new Xt(l.length);for(const t of l){h[n]=t;const r=yield s._parseFile(o,a.opts,a.sync);yield i.renderTemplates(r,a,e),h.forloop.next()}}else{const t=yield s._parseFile(o,a.opts,a.sync);yield i.renderTemplates(t,a,e)}}},oe={parse:function(t){const e=new xt(t.args);this.variable=e.readWord().content},render:function(t,e){const s=t.environments;u(s[this.variable])||(s[this.variable]=0),e.write(l(--s[this.variable]))}},ae={parse:function(t){const e=new xt(t.args),s=e.readValue();for(e.skipBlank(),this.candidates=[],s&&(":"===e.peek()?(this.group=s,e.advance()):this.candidates.push(s));!e.end();){const t=e.readValue();t&&this.candidates.push(t),e.readTo(",")}dt(this.candidates.length,()=>"empty candidates: "+t.getText())},render:function(t,e){const s=`cycle:${Dt(this.group,t)}:`+this.candidates.join(","),r=t.getRegister("cycle");let n=r[s];void 0===n&&(n=r[s]=0);const i=this.candidates[n];n=(n+1)%this.candidates.length,r[s]=n;const o=Dt(i,t);e.write(o)}},he={parse:function(t,e){let s;this.branches=[],this.elseTemplates=[];const r=this.liquid.parser.parseStream(e).on("start",()=>this.branches.push({cond:t.args,templates:s=[]})).on("tag:elsif",t=>{this.branches.push({cond:t.args,templates:s=[]})}).on("tag:else",()=>s=this.elseTemplates).on("tag:endif",()=>r.stop()).on("template",t=>s.push(t)).on("end",()=>{throw new Error(`tag ${t.getText()} not closed`)});r.start()},render:function*(t,e){const s=this.liquid.renderer;for(const r of this.branches){if(Lt(yield new Nt(r.cond).value(t),t))return void(yield s.renderTemplates(r.templates,t,e))}yield s.renderTemplates(this.elseTemplates,t,e)}},le={parse:function(t){const e=new xt(t.args);this.variable=e.readWord().content},render:function(t,e){const s=t.environments;u(s[this.variable])||(s[this.variable]=0);const r=s[this.variable];s[this.variable]++,e.write(l(r))}},ce={parse:function(t,e){const s=new xt(t.args),r=this.liquid.options.dynamicPartials?s.readValue():s.readFileName();dt(r,()=>`illegal argument "${t.args}"`),this.file=r,this.hash=new Pt(s.remaining()),this.tpls=this.liquid.parser.parse(e)},render:function*(t,e){const{liquid:s,hash:r,file:n}=this,{renderer:i}=s,o=t.opts.dynamicPartials?P(n)?yield i.renderTemplates(s.parse(At(n)),t):Dt(this.file,t):n.getText();dt(o,()=>`illegal filename "${n.getText()}":"${o}"`),t.setRegister("blockMode",re.STORE);const a=t.getRegister("blocks"),h=yield i.renderTemplates(this.tpls,t);void 0===a[""]&&(a[""]=h);const l=yield s._parseFile(o,t.opts,t.sync);t.push(yield r.render(t)),t.setRegister("blockMode",re.OUTPUT);const c=yield i.renderTemplates(l,t);t.pop(),e.write(c)}},ue={parse:function(t,e){const s=/\w+/.exec(t.args);this.block=s?s[0]:"",this.tpls=[];const r=this.liquid.parser.parseStream(e).on("tag:endblock",()=>r.stop()).on("template",t=>this.tpls.push(t)).on("end",()=>{throw new Error(`tag ${t.getText()} not closed`)});r.start()},render:function*(t,e){const s=t.getRegister("blocks"),r=s[this.block],n=this.liquid.renderer,i=void 0!==r?r:yield n.renderTemplates(this.tpls,t);t.getRegister("blockMode",re.OUTPUT)!==re.STORE?e.write(i):s[this.block]=i}},pe={parse:function(t,e){this.tokens=[];const s=this.liquid.parser.parseStream(e);s.on("token",t=>{"endraw"===t.name?s.stop():this.tokens.push(t)}).on("end",()=>{throw new Error(`tag ${t.getText()} not closed`)}),s.start()},render:function(){return this.tokens.map(t=>t.getText()).join("")}};class de extends Xt{constructor(t,e){super(t),this.length=t,this.cols=e}row(){return Math.floor(this.i/this.cols)+1}col0(){return this.i%this.cols}col(){return this.col0()+1}col_first(){return 0===this.col0()}col_last(){return this.col()===this.cols}}const fe={assign:It,for:Zt,capture:Kt,case:ee,comment:se,include:ne,render:ie,decrement:oe,increment:le,cycle:ae,if:he,layout:ce,block:ue,raw:pe,tablerow:{parse:function(t,e){const s=new xt(t.args);this.variable=s.readWord(),s.skipBlank();const r=s.readWord();let n;dt(r&&"in"===r.content,()=>"illegal tag: "+t.getText()),this.collection=s.readValue(),this.hash=new Pt(s.remaining()),this.templates=[];const i=this.liquid.parser.parseStream(e).on("start",()=>n=this.templates).on("tag:endtablerow",()=>i.stop()).on("template",t=>n.push(t)).on("end",()=>{throw new Error(`tag ${t.getText()} not closed`)});i.start()},render:function*(t,e){let s=Yt(yield Dt(this.collection,t));const r=yield this.hash.render(t),n=r.offset||0,i=void 0===r.limit?s.length:r.limit;s=s.slice(n,n+i);const o=r.cols||s.length,a=this.liquid.renderer,h=new de(s.length,o),l={tablerowloop:h};t.push(l);for(let r=0;r<s.length;r++,h.next())l[this.variable.content]=s[r],0===h.col0()&&(1!==h.row()&&e.write("</tr>"),e.write(`<tr class="row${h.row()}">`)),e.write(`<td class="col${h.col()}">`),yield a.renderTemplates(this.templates,t,e),e.write("</td>");s.length&&e.write("</tr>"),t.pop()}},unless:{parse:function(t,e){let s;this.templates=[],this.elseTemplates=[];const r=this.liquid.parser.parseStream(e).on("start",()=>{s=this.templates,this.cond=t.args}).on("tag:else",()=>s=this.elseTemplates).on("tag:endunless",()=>r.stop()).on("template",t=>s.push(t)).on("end",()=>{throw new Error(`tag ${t.getText()} not closed`)});r.start()},render:function*(t,e){const s=this.liquid.renderer,r=yield new Nt(this.cond).value(t);yield Mt(r,t)?s.renderTemplates(this.templates,t,e):s.renderTemplates(this.elseTemplates,t,e)}},break:{render:function(t,e){e.break=!0}},continue:{render:function(t,e){e.continue=!0}}},ge={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},me={"&amp;":"&","&lt;":"<","&gt;":">","&#34;":'"',"&#39;":"'"};function we(t){return l(t).replace(/&|<|>|"|'/g,t=>ge[t])}const ye=Math.abs,Te=Math.max,ke=Math.min,be=Math.ceil,ve=Math.floor;const xe=/%([-_0^#:]+)?(\d+)?([EO])?(.)/,Se=["January","February","March","April","May","June","July","August","September","October","November","December"],Oe=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],qe=Se.map(Le),Re=Oe.map(Le),Fe={1:"st",2:"nd",3:"rd",default:"th"};function Le(t){return t.slice(0,3)}function Me(t){return[31,function(t){const e=t.getFullYear();return!(0!=(3&e)||!(e%100||e%400==0&&e))}(t)?29:28,31,30,31,30,31,31,30,31,30,31]}function Ee(t){let e=0;for(let s=0;s<t.getMonth();++s)e+=Me(t)[s];return e+t.getDate()}function Ne(t,e){const s=Ee(t)+(e-t.getDay()),r=7-new Date(t.getFullYear(),0,1).getDay()+e;return String(Math.floor((s-r)/7)+1)}const De={d:2,e:2,H:2,I:2,j:3,k:2,l:2,L:3,m:2,M:2,S:2,U:2,W:2},Ae={a:" ",A:" ",b:" ",B:" ",c:" ",e:" ",k:" ",l:" ",p:" ",P:" "},$e={a:t=>Re[t.getDay()],A:t=>Oe[t.getDay()],b:t=>qe[t.getMonth()],B:t=>Se[t.getMonth()],c:t=>t.toLocaleString(),C:t=>function(t){return parseInt(t.getFullYear().toString().substring(0,2),10)}(t),d:t=>t.getDate(),e:t=>t.getDate(),H:t=>t.getHours(),I:t=>String(t.getHours()%12||12),j:t=>Ee(t),k:t=>t.getHours(),l:t=>String(t.getHours()%12||12),L:t=>t.getMilliseconds(),m:t=>t.getMonth()+1,M:t=>t.getMinutes(),N:(t,e)=>{const s=Number(e.width)||9;return function(t,e,s=" "){return T(t,e,s,(t,e)=>t+e)}(String(t.getMilliseconds()).substr(0,s),s,"0")},p:t=>t.getHours()<12?"AM":"PM",P:t=>t.getHours()<12?"am":"pm",q:t=>function(t){const e=t.getDate().toString(),s=parseInt(e.slice(-1));return Fe[s]||Fe.default}(t),s:t=>Math.round(t.valueOf()/1e3),S:t=>t.getSeconds(),u:t=>t.getDay()||7,U:t=>Ne(t,0),w:t=>t.getDay(),W:t=>Ne(t,1),x:t=>t.toLocaleDateString(),X:t=>t.toLocaleTimeString(),y:t=>t.getFullYear().toString().substring(2,4),Y:t=>t.getFullYear(),z:(t,e)=>{const s=t.getTimezoneOffset(),r=Math.abs(s),n=r%60;return(s>0?"-":"+")+y(Math.floor(r/60),2,"0")+(e.flags[":"]?":":"")+y(n,2,"0")},t:()=>"\t",n:()=>"\n","%":()=>"%"};function Pe(t,e){const[s,r="",n,i,o]=e,a=$e[o];if(!a)return s;const h={};for(const t of r)h[t]=!0;let l=String(a(t,{flags:h,width:n,modifier:i})),c=Ae[o]||"0",u=n||De[o]||0;var p;return h["^"]?l=l.toUpperCase():h["#"]&&(p=l,l=[...p].some(t=>t>="a"&&t<="z")?p.toUpperCase():p.toLowerCase()),h._?c=" ":h[0]&&(c="0"),h["-"]&&(u=0),y(l,u,c)}$e.h=$e.b;var Ve=Object.freeze({escape:we,escapeOnce:function(t){return we(function(t){return String(t).replace(/&(amp|lt|gt|#34|#39);/g,t=>me[t])}(t))},newlineToBr:function(t){return t.replace(/\n/g,"<br/>")},stripHtml:function(t){return t.replace(/<script.*?<\/script>|<!--.*?-->|<style.*?<\/style>|<.*?>/g,"")},abs:ye,atLeast:Te,atMost:ke,ceil:be,dividedBy:(t,e)=>t/e,floor:ve,minus:(t,e)=>t-e,modulo:(t,e)=>t%e,times:(t,e)=>t*e,round:function(t,e=0){const s=Math.pow(10,e);return Math.round(t*s)/s},plus:function(t,e){return Number(t)+Number(e)},sortNatural:function(t,e){return t&&t.sort?void 0!==e?[...t].sort((t,s)=>v(t[e],s[e])):[...t].sort(v):[]},urlDecode:t=>t.split("+").map(decodeURIComponent).join(" "),urlEncode:t=>t.split(" ").map(encodeURIComponent).join("+"),join:(t,e)=>t.join(void 0===e?" ":e),last:t=>d(t)?g(t):"",first:t=>d(t)?t[0]:"",reverse:t=>[...t].reverse(),sort:function(t,e){const s=t=>e?this.context.getFromScope(t,e.split(".")):t;return Gt(t).sort((t,e)=>(t=s(t))<(e=s(e))?-1:t>e?1:0)},size:t=>t&&t.length||0,map:function(t,e){return Gt(t).map(t=>this.context.getFromScope(t,e.split(".")))},concat:function(t,e){return Gt(t).concat(e)},slice:function(t,e,s=1){return e=e<0?t.length+e:e,t.slice(e,e+s)},where:function(t,e,s){return Gt(t).filter(t=>{const r=this.context.getFromScope(t,String(e).split("."));return void 0===s?Lt(r,this.context):r===s})},uniq:function(t){const e={};return(t||[]).filter(t=>!e.hasOwnProperty(String(t))&&(e[String(t)]=!0,!0))},date:function(t,e){let s=t;return"now"===t||"today"===t?s=new Date:u(t)?s=new Date(1e3*t):a(t)&&(s=/^\d+$/.test(t)?new Date(1e3*+t):new Date(t)),function(t){return t instanceof Date&&!isNaN(t.getTime())}(s)?function(t,e){let s,r="",n=e;for(;s=xe.exec(n);)r+=n.slice(0,s.index),n=n.slice(s.index+s[0].length),r+=Pe(t,s);return r+n}(s,e):t},Default:function(t,e){return d(t)||a(t)?t.length?t:e:Mt(c(t),this.context)?e:t},json:function(t){return JSON.stringify(t)},append:function(t,e){return dt(void 0!==e,()=>"append expect 2 arguments"),l(t)+l(e)},prepend:function(t,e){return dt(void 0!==e,()=>"prepend expect 2 arguments"),l(e)+l(t)},lstrip:function(t){return l(t).replace(/^\s+/,"")},downcase:function(t){return l(t).toLowerCase()},upcase:function(t){return l(t).toUpperCase()},remove:function(t,e){return l(t).split(e).join("")},removeFirst:function(t,e){return l(t).replace(e,"")},rstrip:function(t){return l(t).replace(/\s+$/,"")},split:function(t,e){return l(t).split(e)},strip:function(t){return l(t).trim()},stripNewlines:function(t){return l(t).replace(/\n/g,"")},capitalize:function(t){return(t=l(t)).charAt(0).toUpperCase()+t.slice(1)},replace:function(t,e,s){return l(t).split(e).join(s)},replaceFirst:function(t,e,s){return l(t).replace(e,s)},truncate:function(t,e=50,s="..."){return(t=l(t)).length<=e?t:t.substr(0,e-s.length)+s},truncatewords:function(t,e=15,s="..."){const r=t.split(/\s+/);let n=r.slice(0,e).join(" ");return r.length>=e&&(n+=s),n}});class je{constructor(){this.impls={}}get(t){const e=this.impls[t];return dt(e,()=>`tag "${t}" not found`),e}set(t,e){this.impls[t]=e}}class We{constructor(t){this.strictFilters=t,this.impls={}}get(t){const e=this.impls[t];return dt(e||!this.strictFilters,()=>"undefined filter: "+t),e}set(t,e){this.impls[t]=e}create(t,e){return new _t(t,this.get(t),e)}}class Ce{constructor(t={}){var e;this.options=(e=q(t),Object.assign({},O,e)),this.parser=new Qt(this),this.renderer=new Ot,this.fs=t.fs||M,this.filters=new We(this.options.strictFilters),this.tags=new je,f(fe,(t,e)=>this.registerTag(b(e),t)),f(Ve,(t,e)=>this.registerFilter(b(e),t))}parse(t,e){const s=new xt(t,e).readTopLevelTokens(this.options);return this.parser.parse(s)}_render(t,e,s,r){const n=Object.assign({},this.options,q(s)),i=new F(e,n,r);return this.renderer.renderTemplates(t,i)}async render(t,e,s){return Ct(this._render(t,e,s,!1))}renderSync(t,e,s){return Bt(this._render(t,e,s,!0))}_parseAndRender(t,e,s,r){const n=this.parse(t);return this._render(n,e,s,r)}async parseAndRender(t,e,s){return Ct(this._parseAndRender(t,e,s,!1))}parseAndRenderSync(t,e,s){return Bt(this._parseAndRender(t,e,s,!0))}*_parseFile(t,e,s){const r=Object.assign({},this.options,q(e)),n=r.root.map(e=>this.fs.resolve(e,t,r.extname));if(void 0!==this.fs.fallback){const e=this.fs.fallback(t);void 0!==e&&n.push(e)}for(const t of n){const{cache:e}=r;if(e){const s=yield e.read(t);if(s)return s}if(!(s?this.fs.existsSync(t):yield this.fs.exists(t)))continue;const n=this.parse(s?this.fs.readFileSync(t):yield this.fs.readFile(t),t);return e&&e.write(t,n),n}throw this.lookupError(t,r.root)}async parseFile(t,e){return Ct(this._parseFile(t,e,!1))}parseFileSync(t,e){return Bt(this._parseFile(t,e,!0))}async renderFile(t,e,s){const r=await this.parseFile(t,s);return this.render(r,e,s)}renderFileSync(t,e,s){const r=q(s),n=this.parseFileSync(t,r);return this.renderSync(n,e,s)}_evalValue(t,e){return new zt(t,this.filters).value(e)}async evalValue(t,e){return Ct(this._evalValue(t,e))}evalValueSync(t,e){return Bt(this._evalValue(t,e))}registerFilter(t,e){this.filters.set(t,e)}registerTag(t,e){this.tags.set(t,e)}plugin(t){return t.call(this,Ce)}express(){const t=this;return function(e,s,r){const n={root:[...R(this.root),...t.options.root]};t.renderFile(e,s,n).then(t=>r(null,t),r)}}lookupError(t,e){const s=new Error("ENOENT");return s.message=`ENOENT: Failed to lookup "${t}" in "${e}"`,s.code="ENOENT",s}async getTemplate(t,e){return this.parseFile(t,e)}getTemplateSync(t,e){return this.parseFileSync(t,e)}}}}]);